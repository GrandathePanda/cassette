!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):"object"==typeof exports?exports.AudioPlayer=t(require("react")):e.AudioPlayer=t(e.React)}(this,function(e){return function(e){function t(a){if(i[a])return i[a].exports;var s=i[a]={exports:{},id:a,loaded:!1};return e[a].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="/dist",t(0)}([function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e){var t=Math.floor(e/60),i=(e%60).toFixed();return""+(t<10?"0":"")+t+":"+(i<10?"0":"")+i}var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),d=i(1),l=a(d),c=i(2),p=a(c),f=i(3),h=a(f);i(4);var m=console.log.bind(console),y=console.error?console.error.bind(console):m,v=console.warn?console.warn.bind(console):m,g=function(e){function t(e){s(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.seekInProgress=!1,i.currentTrackIndex=0,i.defaultState={activeTrackIndex:-1,paused:!0,displayedTime:0},i.state=i.defaultState,i.audio=null,i.audioProgressContainer=null,i.audioProgressBoundingRect=null,i.adjustDisplayedTime=i.adjustDisplayedTime.bind(i),i.seekReleaseListener=function(e){return i.seek(e)},i.resizeListener=function(){return i.fetchAudioProgressBoundingRect()},i.audioPlayListener=function(){return i.setState({paused:!1})},i.audioPauseListener=function(){return i.setState({paused:!0})},i.audioEndListener=function(){var e=i.props.gapLengthInSeconds||0;clearTimeout(i.gapLengthTimeout),i.gapLengthTimeout=setTimeout(function(){return i.skipToNextTrack()},1e3*e)},i.audioStallListener=function(){return i.togglePause(!0)},i.audioTimeUpdateListener=function(){return i.handleTimeUpdate()},i.audioMetadataLoadedListener=function(){return i.setState({activeTrackIndex:i.currentTrackIndex})},i}return r(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("mousemove",this.adjustDisplayedTime),document.addEventListener("touchmove",this.adjustDisplayedTime),window.addEventListener("mouseup",this.seekReleaseListener),document.addEventListener("touchend",this.seekReleaseListener),window.addEventListener("resize",this.resizeListener),this.resizeListener();var t=this.audio=document.createElement("audio");if(t.preload="metadata",t.addEventListener("play",this.audioPlayListener),t.addEventListener("pause",this.audioPauseListener),t.addEventListener("ended",this.audioEndListener),t.addEventListener("stalled",this.audioStallListener),t.addEventListener("timeupdate",this.audioTimeUpdateListener),t.addEventListener("loadedmetadata",this.audioMetadataLoadedListener),this.addMediaEventListeners(this.props.onMediaEvent),this.props.playlist&&this.props.playlist.length&&(this.updateSource(),this.props.autoplay)){var i=this.props.autoplayDelayInSeconds||0;clearTimeout(this.delayTimeout),this.delayTimeout=setTimeout(function(){return e.togglePause(!1)},1e3*i)}this.props.audioElementRef&&this.props.audioElementRef(t)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.adjustDisplayedTime),document.removeEventListener("touchmove",this.adjustDisplayedTime),window.removeEventListener("mouseup",this.seekReleaseListener),document.removeEventListener("touchend",this.seekReleaseListener),window.removeEventListener("resize",this.resizeListener),this.audio.removeEventListener("play",this.audioPlayListener),this.audio.removeEventListener("pause",this.audioPauseListener),this.audio.removeEventListener("ended",this.audioEndListener),this.audio.removeEventListener("stalled",this.audioStallListener),this.audio.removeEventListener("timeupdate",this.audioTimeUpdateListener),this.audio.removeEventListener("loadedmetadata",this.audioMetadataLoadedListener),this.removeMediaEventListeners(this.props.onMediaEvent),clearTimeout(this.gapLengthTimeout),clearTimeout(this.delayTimeout),this.audio.pause(),this.props.audioElementRef&&this.props.audioElementRef(this.audio)}},{key:"componentWillReceiveProps",value:function(e){this.removeMediaEventListeners(this.props.onMediaEvent),this.addMediaEventListeners(e.onMediaEvent);var t=e.playlist;if(!t||!t.length)return this.audio&&(this.audio.src=""),this.currentTrackIndex=0,this.setState(this.defaultState);var i=this.props.playlist,a=((i||[])[this.currentTrackIndex]||{}).url;this.currentTrackIndex=(0,p["default"])(t,function(e){return e.url&&a===e.url}),this.currentTrackIndex!==-1&&this.setState({activeTrackIndex:this.currentTrackIndex})}},{key:"addMediaEventListeners",value:function(e){var t=this;e&&Object.keys(e).forEach(function(i){"function"==typeof e[i]&&t.audio.addEventListener(i,e[i])})}},{key:"removeMediaEventListeners",value:function(e){var t=this;e&&Object.keys(e).forEach(function(i){"function"==typeof e[i]&&t.audio.removeEventListener(i,e[i])})}},{key:"componentDidUpdate",value:function(){this.audio&&this.currentTrackIndex===-1&&this.skipToNextTrack(!1)}},{key:"togglePause",value:function(e){if(this.audio){var t="boolean"==typeof e?e:!this.state.paused;if(t)return this.audio.pause();if(this.props.playlist&&this.props.playlist.length)try{this.audio.play()}catch(i){y(i);var a="Audio playback failed at "+(new Date).toLocaleTimeString()+"! (Perhaps autoplay is disabled in this browser.)";v(a)}}}},{key:"skipToNextTrack",value:function(e){var t=this;if(this.audio&&(this.audio.pause(),this.props.playlist&&this.props.playlist.length)){var i=this.currentTrackIndex+1;i>=this.props.playlist.length&&(i=0),this.currentTrackIndex=i,this.setState({activeTrackIndex:-1,displayedTime:0},function(){t.updateSource();var a=!t.props.cycle&&0===i,s=a||"boolean"==typeof e&&!e;t.togglePause(s)})}}},{key:"backSkip",value:function(){if(this.props.playlist&&this.props.playlist.length){var e=this.audio,t=this.props.stayOnBackSkipThreshold;if(isNaN(t)&&(t=5),e.currentTime>=t)return e.currentTime=0;var i=this.currentTrackIndex-1;i<0&&(i=this.props.playlist.length-1),this.currentTrackIndex=i-1,this.skipToNextTrack()}}},{key:"updateSource",value:function(){this.audio.src=this.props.playlist[this.currentTrackIndex].url}},{key:"fetchAudioProgressBoundingRect",value:function(){this.audioProgressBoundingRect=this.audioProgressContainer.getBoundingClientRect()}},{key:"handleTimeUpdate",value:function(){!this.seekInProgress&&this.audio&&this.setState({displayedTime:this.audio.currentTime})}},{key:"adjustDisplayedTime",value:function(e){if(this.props.playlist&&this.props.playlist.length&&!this.props.disableSeek){if("mousedown"===e.type||"touchstart"===e.type)this.seekInProgress=!0,document.body.classList.add("noselect");else if(!this.seekInProgress)return;e.preventDefault();var t=this.audioProgressBoundingRect,i="touch"===e.type.slice(0,5),a=i?e.targetTouches.item(0).pageX:e.pageX,s=a-t.left-document.body.scrollLeft,n=t.width,r=s/n;this.setState({displayedTime:r*this.audio.duration})}}},{key:"seek",value:function(e){if(document.body.classList.remove("noselect"),this.seekInProgress){e.preventDefault(),this.seekInProgress=!1;var t=this.state.displayedTime;isNaN(t)||(this.audio.currentTime=t)}}},{key:"render",value:function(){var e=this,t=this.state.activeTrackIndex,i=this.props.playlist?t<0?null:this.props.playlist[t].displayText:"Please load a playlist",a=this.state.displayedTime,s=this.audio&&this.audio.duration||0,n=o(a),r=o(s),u=n+" / "+r,d=a/s*100+"%";return l["default"].createElement("div",{id:"audio_player",className:"audio_player",title:i,style:this.props.style},l["default"].createElement("div",{className:"audio_controls"},l["default"].createElement("div",{id:"skip_button",className:(0,h["default"])("skip_button back audio_button",{hidden:this.props.hideBackSkip}),onClick:function(){return e.backSkip()}},l["default"].createElement("div",{className:"skip_button_inner"},l["default"].createElement("div",{className:"right_facing_triangle"}),l["default"].createElement("div",{className:"right_facing_triangle"}))),l["default"].createElement("div",{id:"play_pause_button",className:(0,h["default"])("play_pause_button","audio_button",{paused:this.state.paused}),onClick:function(){return e.togglePause()}},l["default"].createElement("div",{className:"play_pause_inner"},l["default"].createElement("div",{className:"left"}),l["default"].createElement("div",{className:"right"}),l["default"].createElement("div",{className:"triangle_1"}),l["default"].createElement("div",{className:"triangle_2"}))),l["default"].createElement("div",{id:"skip_button",className:(0,h["default"])("skip_button audio_button",{hidden:this.props.hideForwardSkip}),onClick:function(){return e.skipToNextTrack()}},l["default"].createElement("div",{className:"skip_button_inner"},l["default"].createElement("div",{className:"right_facing_triangle"}),l["default"].createElement("div",{className:"right_facing_triangle"})))),l["default"].createElement("div",{id:"audio_progress_container",className:"audio_progress_container",ref:function(t){return e.audioProgressContainer=t},onMouseDown:this.adjustDisplayedTime,onTouchStart:this.adjustDisplayedTime},l["default"].createElement("div",{id:"audio_progress",className:"audio_progress",style:{width:d}}),l["default"].createElement("div",{id:"audio_progress_overlay",className:"audio_progress_overlay"},l["default"].createElement("div",{className:"audio_info_marquee"},l["default"].createElement("div",{id:"audio_info",className:"audio_info noselect",draggable:"false"},i)),l["default"].createElement("div",{id:"audio_time_progress",className:"audio_time_progress noselect",draggable:"false"},u))))}}]),t}(l["default"].Component);g.propTypes={playlist:l["default"].PropTypes.array,autoplay:l["default"].PropTypes.bool,autoplayDelayInSeconds:l["default"].PropTypes.number,gapLengthInSeconds:l["default"].PropTypes.number,hideBackSkip:l["default"].PropTypes.bool,hideForwardSkip:l["default"].PropTypes.bool,cycle:l["default"].PropTypes.bool,disableSeek:l["default"].PropTypes.bool,stayOnBackSkipThreshold:l["default"].PropTypes.number,style:l["default"].PropTypes.object,onMediaEvent:l["default"].PropTypes.object,audioElementRef:l["default"].PropTypes.func},g.defaultProps={cycle:!0},e.exports=g},function(t,i){t.exports=e},function(e,t){"use strict";e.exports=function(e,t,i){if("function"==typeof Array.prototype.findIndex)return e.findIndex(t,i);if("function"!=typeof t)throw new TypeError("predicate must be a function");var a=Object(e),s=a.length;if(0===s)return-1;for(var n=0;n<s;n++)if(t.call(i,a[n],n,a))return n;return-1}},function(e,t,i){var a,s;!function(){"use strict";function i(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var s=typeof a;if("string"===s||"number"===s)e.push(a);else if(Array.isArray(a))e.push(i.apply(null,a));else if("object"===s)for(var r in a)n.call(a,r)&&a[r]&&e.push(r)}}return e.join(" ")}var n={}.hasOwnProperty;"undefined"!=typeof e&&e.exports?e.exports=i:(a=[],s=function(){return i}.apply(t,a),!(void 0!==s&&(e.exports=s)))}()},function(e,t){}])});