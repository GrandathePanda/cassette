!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("prop-types"),require("react")):"function"==typeof define&&define.amd?define(["prop-types","react"],t):"object"==typeof exports?exports.cassetteCore=t(require("prop-types"),require("react")):e.cassetteCore=t(e.PropTypes,e.React)}("undefined"!=typeof self?self:this,function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist",n(n.s=7)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=console.log.bind(console),i=console.error?console.error.bind(console):r,a=console.warn?console.warn.bind(console):r},function(e,t,n){"use strict";(function(e){var r=n(1),i=n(2),a=n(6).version,s="undefined"==typeof window?e:window;s.__cassette_contexts__=s.__cassette_contexts__||{},t.a=function(e,t){void 0===t&&(t=null);var n=s.__cassette_contexts__[e];if(n)return n.packageVersion!==a&&Object(i.b)("Warning: multiple versions of "+e+" from the @cassette/core package have been loaded. v"+a+" will be ignored and v"+n.packageVersion+" will be used instead."),n;var o=Object(r.createContext)(t);return o.displayName=e,o.packageVersion=a,s.__cassette_contexts__[e]=o,o}}).call(this,n(5))},function(e,t,n){"use strict";e.exports=function(e,t,n){if("function"==typeof Array.prototype.findIndex)return e.findIndex(t,n);if("function"!=typeof t)throw new TypeError("predicate must be a function");var r=Object(e),i=r.length;if(0===i)return-1;for(var a=0;a<i;a++)if(t.call(n,r[a],a,r))return a;return-1}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e){e.exports={name:"@cassette/core",version:"2.0.0-alpha.7",description:"A simple, clean, and responsive visual wrapper for the HTML audio tag, built with React.",main:"dist/es5/cassette-core.js",scripts:{"build:clean":"rimraf dist","build:webpack":"BUILD_MODE=all webpack --progress",build:"npm run build:clean && npm run build:webpack",prepare:"npm run build",test:'echo "Error: no test specified" && exit 1'},repository:{type:"git",url:"https://github.com/benwiley4000/cassette.git"},engines:{node:">=6.0.0",npm:">=5.0.0"},keywords:["audio","video","media","ui","react","reactjs","responsive","music","player","html5","component","components"],author:{name:"Ben Wiley",email:"therealbenwiley@gmail.com",url:"http://benwiley.org/"},license:"MIT",peerDependencies:{react:"^16.3.0"},devDependencies:{"array-find-index":"^1.0.2",rimraf:"^2.5.4",webpack:"^4.17.1"},dependencies:{"prop-types":"^15.5.10"},publishConfig:{access:"public"}}},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"controlKeyword",function(){return g}),n.d(r,"control",function(){return v}),n.d(r,"crossOriginAttribute",function(){return y}),n.d(r,"repeatStrategy",function(){return b}),n.d(r,"mediaSource",function(){return k}),n.d(r,"mediaSessionAction",function(){return S}),n.d(r,"mediaSessionArtwork",function(){return E}),n.d(r,"track",function(){return w}),n.d(r,"progressDirection",function(){return T}),n.d(r,"seekMode",function(){return P}),n.d(r,"aspectRatio",function(){return O});var i=n(1),a=n.n(i),s=n(0),o=n.n(s),l=n(4),u=n.n(l),c=n(3),d=Object(c.a)("PlayerContext"),p=Object(c.a)("GroupContext"),h=["none","playlist","track"],f=n(2);function m(e,t){var n=!1;return function(r,i,a){if(i in r){!n&&t in r&&(Object(f.b)("Do not define both the '"+i+"' and '"+t+"' props."),n=!0);for(var s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return e.isRequired.apply(e,[r,i,a].concat(o))}if(!(t in r))return new Error("If the '"+t+"' prop is not defined, '"+i+"' must be.")}}var g=o.a.oneOf(["playpause","backskip","forwardskip","volume","mute","repeat","shuffle","progress","progressdisplay","fullscreen","spacer"]),v=o.a.oneOfType([o.a.func,g]),y=o.a.oneOf(["anonymous","use-credentials"]),b=o.a.oneOf(h),k=o.a.shape({src:o.a.string.isRequired,type:o.a.string.isRequired}),S=o.a.oneOf(["play","pause","previoustrack","nexttrack","seekbackward","seekforward"]),E=o.a.shape({src:o.a.string.isRequired,sizes:o.a.string,type:o.a.string}),w=o.a.shape({url:m(o.a.string,"sources"),sources:m(o.a.arrayOf(k.isRequired),"url"),title:o.a.string.isRequired,artist:o.a.string,album:o.a.string,artwork:o.a.arrayOf(E.isRequired),meta:o.a.object}),T=o.a.oneOf(["left","right","up","down"]),P=o.a.oneOf(["paused","immediate","onrelease"]);function O(e,t){var n=e[t];if(void 0!==n)return"string"!=typeof n||2!==n.split(":").length||n.split(":").some(isNaN)?new Error("The "+t+" prop should be a string of the form 'x:y'. Example: 16:9"):void 0}var x="loopchange",R="srcrequest";var M=function(){var e=document.createElement("video");return new MutationObserver(function(){e.dispatchEvent(new Event(x))}).observe(e,{attributeFilter:["loop"]}),Object.defineProperty(e,"src",{get:function(){return e.currentSrc},set:function(t){var n=new Event(R);n.srcRequested=t,e.dispatchEvent(n)}}),e};function C(e,t,n,r){for(var i=r,a=0;a<e;a++){if(!t.length)throw C(a,n,t,i),"Moving "+e+" places was not possible!";n.push(i),i=t.pop()}return i}function _(e,t,n,r,i){var a=r;if(e.length){for(var s=1;s<=t.length;s++)if(-1!==e.indexOf(t[t.length-s]))return C(s,t,n,a);if(i){if(function(e,t){if(!e.length)return!1;for(var n=0;n<e.length;n++)if(t!==e[n])return!1;return!0}(e,a))return a;var o;do{o=e[Math.floor(Math.random()*e.length)]}while(a===o||void 0===o);return void 0!==(a=C(t.length,t,n,a))&&n.push(a),o}}}var I=function(){function e(e,t){void 0===t&&(t={}),this._list=e,this._forwardStack=[],this._backStack=[],this._currentItem=void 0,this._allowBackShuffle=Boolean(t.allowBackShuffle)}var t=e.prototype;return t.findNextItem=function(e){return void 0!==e&&this.setCurrentIndex(e),this._currentItem=_(this._list,this._forwardStack,this._backStack,this._currentItem,!0),this._currentItem},t.findPreviousItem=function(e){return void 0!==e&&this.setCurrentIndex(e),this._currentItem=_(this._list,this._backStack,this._forwardStack,this._currentItem,this._allowBackShuffle),this._currentItem},t.pickNextItem=function(e,t){if(void 0!==t&&this.setCurrentIndex(t),void 0!==this._list[e])return void 0!==this._currentItem&&this._backStack.push(this._currentItem),this._forwardStack.length=0,this._currentItem=this._list[e],this._currentItem},t.setList=function(e){this._list=e},t.setOptions=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n];switch(r){case"allowBackShuffle":this["_"+r]=Boolean(e[r])}}},t.setCurrentIndex=function(e){var t=this._list[e];this._currentItem!==t&&(this.clear(),this._currentItem=t)},t.clear=function(){this._forwardStack.length=0,this._backStack.length=0,this._currentItem=void 0},e}();var q=function(e){return Boolean(e&&e.length)},F=[{src:""}];var L=function(e,t){if(!q(e))return F;var n=e[t],r=n.sources,i=n.url;return r?r.length?r:F:[{src:i}]};var j=function(e,t){return u()(e,function(e){return e.sources?-1!==u()(e.sources,function(e){return e.src===t}):e.url&&t===e.url})};var V=function(e){return(e||[]).map(function(t,n){return L(e,n)[0].src})};var H=function(e){for(var t=Array(e.length),n=0;n<e.length;n++)t[n]={start:e.start(n),end:e.end(n)};return t};var A=function(e,t){return e?"track":t?"playlist":"none"};var D=function(e,t,n){return t="number"==typeof t?t:-1/0,n="number"==typeof n?n:1/0,Math.max(t,Math.min(e,n))};function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){U(e,t,n[t])})}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e){if(Object(f.a)(e),"NotAllowedError"===e.name){var t="Media playback failed at "+(new Date).toLocaleTimeString()+"! (Perhaps autoplay is disabled in this browser.)";Object(f.b)(t)}}var K=["previoustrack","nexttrack","seekbackward","seekforward"],J={paused:!0,currentTime:0,seekPreviewTime:0,seekInProgress:!1,awaitingResumeOnSeekComplete:!1,duration:0,bufferedRanges:[],playedRanges:[],seekableRanges:[],stalled:!1,awaitingPlay:!1};function Q(e,t,n){void 0===n&&(n=!0);var r=e.activeTrackIndex!==t;return{activeTrackIndex:t,trackLoading:r,currentTime:0,loop:!r&&e.loop,awaitingPlay:Boolean(n),paused:!n}}function X(e,t){for(var n;n=e.firstChild;)e.removeChild(n);var r=t,i=Array.isArray(r),a=0;for(r=i?r:r[Symbol.iterator]();;){var s;if(i){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var o=s,l=document.createElement("source");l.src=o.src,o.type&&(l.type=o.type),e.appendChild(l)}e.load()}var Y=function(e){function t(t){var n;return(n=e.call(this,t)||this).state=N({},J,{activeTrackIndex:D(t.startingTrackIndex,0),trackLoading:q(t.playlist),currentTime:D(t.startingTime,0),volume:D(t.defaultVolume,0,1),muted:t.defaultMuted,loop:"track"===t.defaultRepeatStrategy,cycle:"playlist"===t.defaultRepeatStrategy,shuffle:t.defaultShuffle,playbackRate:t.defaultPlaybackRate,setVolumeInProgress:!1,awaitingPlay:t.autoplay&&q(t.playlist),__playlist__:t.playlist},t.initialStateSnapshot?function(e,t){var n=e.__unstable__,r=n.paused,i=n.currentTime,a=n.activeTrackIndex,s=n.volume,o=n.muted,l=n.loop,u=n.cycle,c=n.shuffle,d=n.playbackRate,p=n.activeTrackSrc,h={};q(t.playlist)&&"boolean"==typeof r&&(h.awaitingPlay=!r),"number"==typeof s&&s>=0&&s<=1&&(h.volume=s),"boolean"==typeof o&&(h.muted=o),"boolean"==typeof l&&(h.loop=l),"boolean"==typeof u&&(h.cycle=u),"boolean"==typeof c&&(h.shuffle=c),"number"==typeof d&&(h.playbackRate=d);var f=!1;if("string"==typeof p&&"number"==typeof a&&a>=0)if(p===L(t.playlist,a)[0].src)h.activeTrackIndex=a,f=!0;else{var m=j(t.playlist,p);-1!==m&&(h.activeTrackIndex=m,f=!0)}return f&&"number"==typeof i&&i>=0&&(h.currentTime=i),h}(t.initialStateSnapshot,t):{}),n.lastStableVolume=n.state.volume,n.shuffler=new I(V(t.playlist),{allowBackShuffle:t.allowBackShuffle}),n.media=null,n.videoHostElementList=[],n.videoHostOccupiedCallbacks=new Map,n.videoHostVacatedCallbacks=new Map,n.togglePause=n.togglePause.bind(W(n)),n.selectTrackIndex=n.selectTrackIndex.bind(W(n)),n.forwardSkip=n.forwardSkip.bind(W(n)),n.backSkip=n.backSkip.bind(W(n)),n.seekPreview=n.seekPreview.bind(W(n)),n.seekComplete=n.seekComplete.bind(W(n)),n.setVolume=n.setVolume.bind(W(n)),n.setVolumeComplete=n.setVolumeComplete.bind(W(n)),n.toggleMuted=n.toggleMuted.bind(W(n)),n.toggleShuffle=n.toggleShuffle.bind(W(n)),n.setRepeatStrategy=n.setRepeatStrategy.bind(W(n)),n.setPlaybackRate=n.setPlaybackRate.bind(W(n)),n.registerVideoHostElement=n.registerVideoHostElement.bind(W(n)),n.renderVideoIntoHostElement=n.renderVideoIntoHostElement.bind(W(n)),n.unregisterVideoHostElement=n.unregisterVideoHostElement.bind(W(n)),n.updateVideoHostElement=n.updateVideoHostElement.bind(W(n)),n.handleMediaPlay=n.handleMediaPlay.bind(W(n)),n.handleMediaPause=n.handleMediaPause.bind(W(n)),n.handleMediaSrcrequest=n.handleMediaSrcrequest.bind(W(n)),n.handleMediaEnded=n.handleMediaEnded.bind(W(n)),n.handleMediaStalled=n.handleMediaStalled.bind(W(n)),n.handleMediaCanplaythrough=n.handleMediaCanplaythrough.bind(W(n)),n.handleMediaTimeupdate=n.handleMediaTimeupdate.bind(W(n)),n.handleMediaLoadedmetadata=n.handleMediaLoadedmetadata.bind(W(n)),n.handleMediaVolumechange=n.handleMediaVolumechange.bind(W(n)),n.handleMediaDurationchange=n.handleMediaDurationchange.bind(W(n)),n.handleMediaProgress=n.handleMediaProgress.bind(W(n)),n.handleMediaLoopchange=n.handleMediaLoopchange.bind(W(n)),n.handleMediaRatechange=n.handleMediaRatechange.bind(W(n)),n}z(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this,t=this.media=M(),n=this.props,r=n.defaultPlaybackRate,i=n.crossOrigin,a=n.playlist,s=n.autoplayDelayInSeconds,o=n.mediaElementRef,l=n.getPosterImageForTrack,u=n.onActiveTrackUpdate,c=this.state,d=c.volume,p=c.muted,h=c.playbackRate,f=c.loop,m=c.activeTrackIndex,g=c.awaitingPlay;t.defaultPlaybackRate=r,t.crossOrigin=i,t.volume=d,t.muted=p,t.playbackRate=h,t.loop=f,t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline",""),t.setAttribute("preload","metadata"),t.setAttribute("poster",l(a[m])),t.addEventListener("play",this.handleMediaPlay),t.addEventListener("pause",this.handleMediaPause),t.addEventListener("ended",this.handleMediaEnded),t.addEventListener("etalled",this.handleMediaStalled),t.addEventListener("canplaythrough",this.handleMediaCanplaythrough),t.addEventListener("timeupdate",this.handleMediaTimeupdate),t.addEventListener("loadedmetadata",this.handleMediaLoadedmetadata),t.addEventListener("volumechange",this.handleMediaVolumechange),t.addEventListener("durationchange",this.handleMediaDurationchange),t.addEventListener("progress",this.handleMediaProgress),t.addEventListener("ratechange",this.handleMediaRatechange),t.addEventListener("srcrequest",this.handleMediaSrcrequest),t.addEventListener("loopchange",this.handleMediaLoopchange),X(t,L(a,m)),this.mediaContainer.appendChild(t),g&&(this.setState({awaitingPlay:!1}),this.delayTimeout=setTimeout(function(){e.togglePause(!1)},1e3*s)),o&&o(t),u&&u(a[m],m)},t.getDerivedStateFromProps=function(e,t){var n=e.playlist;if(n===t.__playlist__)return null;var r={__playlist__:n};if(!q(n))return N({},J,r,{activeTrackIndex:0,trackLoading:!1});var i=L(t.__playlist__,t.activeTrackIndex),a=L(n,t.activeTrackIndex);if(i[0].src===a[0].src)return r;var s=j(n,i[0].src);return N({},r,-1!==s?{activeTrackIndex:s}:Q(t,0,!1))},n.componentDidUpdate=function(e,t){var n=this;this.media.defaultPlaybackRate=this.props.defaultPlaybackRate,this.media.crossOrigin=this.props.crossOrigin,this.shuffler.setList(V(this.props.playlist)),this.shuffler.setOptions({allowBackShuffle:this.props.allowBackShuffle});var r=L(e.playlist,t.activeTrackIndex),i=L(this.props.playlist,this.state.activeTrackIndex),a=e.playlist[t.activeTrackIndex],s=this.props.playlist[this.state.activeTrackIndex];r[0].src!==i[0].src&&(X(this.media,i),this.media.setAttribute("poster",this.props.getPosterImageForTrack(s)),this.state.shuffle||this.shuffler.clear()),this.props.onActiveTrackUpdate&&a!==s&&this.props.onActiveTrackUpdate(s,this.state.activeTrackIndex),e===this.props||this.media.paused||this.stealMediaSession(),this.state.awaitingPlay&&(this.setState({awaitingPlay:!1}),setTimeout(function(){n.togglePause(!1)})),clearTimeout(this.snapshotUpdateTimeout),this.snapshotUpdateTimeout=setTimeout(function(){n.props.onStateSnapshot&&n.props.onStateSnapshot(function(e){var t=e.paused,n=e.currentTime,r=e.activeTrackIndex,i=e.volume,a=e.muted,s=e.loop,o=e.cycle,l=e.shuffle,u=e.playbackRate,c=e.__playlist__;return{__unstable__:{paused:t,currentTime:n,activeTrackIndex:r,volume:i,muted:a,loop:s,cycle:o,shuffle:l,playbackRate:u,activeTrackSrc:q(c)?L(c,r)[0].src:null}}}(n.state))},100)},n.componentWillUnmount=function(){var e=this.media;e.removeEventListener("srcrequest",this.handleMediaSrcrequest),e.removeEventListener("loopchange",this.handleMediaLoopchange),clearTimeout(this.gapLengthTimeout),clearTimeout(this.delayTimeout)},n.stealMediaSession=function(){var e=this;window.MediaSession&&navigator.mediaSession instanceof MediaSession&&(navigator.mediaSession.metadata=new MediaMetadata(this.props.playlist[this.state.activeTrackIndex]),K.map(function(t){if(-1===e.props.supportedMediaSessionActions.indexOf(t))return null;var n=e.props.mediaSessionSeekLengthInSeconds;switch(t){case"play":return e.togglePause.bind(e,!1);case"pause":return e.togglePause.bind(e,!0);case"previoustrack":return e.backSkip;case"nexttrack":return e.forwardSkip;case"seekbackward":return function(){return e.media.currentTime-=n};case"seekforward":return function(){return e.media.currentTime+=n};default:return}}).forEach(function(e,t){navigator.mediaSession.setActionHandler(K[t],e)}))},n.registerVideoHostElement=function(e,t){var n=t.onHostOccupied,r=t.onHostVacated;this.videoHostElementList=this.videoHostElementList.concat(e),this.videoHostOccupiedCallbacks.set(e,n),this.videoHostVacatedCallbacks.set(e,r)},n.renderVideoIntoHostElement=function(e){var t=this;-1!==this.videoHostElementList.indexOf(e)&&(cancelAnimationFrame(this.videoHostUpdateRaf),this.videoHostUpdateRaf=requestAnimationFrame(function(){return t.updateVideoHostElement(e)}))},n.unregisterVideoHostElement=function(e){this.videoHostElementList=this.videoHostElementList.filter(function(t){return t!==e}),this.videoHostOccupiedCallbacks.delete(e),this.videoHostVacatedCallbacks.delete(e),this.media.parentNode===e&&this.updateVideoHostElement()},n.updateVideoHostElement=function(e){e?this.videoHostElementList=[e].concat(this.videoHostElementList.filter(function(t){return t!==e})):e=this.videoHostElementList[0]||this.mediaContainer;var t=!this.media.paused,n=this.media.parentNode;if(e!==n){e.appendChild(this.media),t&&this.media.paused&&this.media.play();var r=this.videoHostVacatedCallbacks.get(n);r&&r(this.media);var i=this.videoHostOccupiedCallbacks.get(e);i&&i(this.media)}},n.handleMediaPlay=function(){this.setState(function(e){return!1===e.paused?null:{paused:!1}}),this.stealMediaSession()},n.handleMediaPause=function(){this.setState(function(e){return!0===e.paused?null:{paused:!0}})},n.handleMediaSrcrequest=function(e){var t=this.props.playlist,n=L(t,this.state.activeTrackIndex);if(-1===u()(n,function(t){return t.src===e.srcRequested})){var r=j(t,e.srcRequested);-1!==r?this.selectTrackIndex(r):Object(f.a)("Source '"+e.srcRequested+"' does not exist in the loaded playlist. Make sure you've updated the 'playlist' prop to PlayerContextProvider before you select this track!")}},n.handleMediaEnded=function(){if(!this.state.seekInProgress){clearTimeout(this.gapLengthTimeout);var e=this.props,t=e.playlist,n=e.loadFirstTrackOnPlaylistComplete;if(q(t)){var r=this.state,i=r.cycle,a=r.activeTrackIndex;!i&&a+1>=t.length?n&&this.goToTrack(0,!1):this.gapLengthTimeout=setTimeout(this.forwardSkip,1e3*this.props.gapLengthInSeconds)}}},n.handleMediaStalled=function(){this.setState(function(e){return!0===e.stalled?null:{stalled:!0}})},n.handleMediaCanplaythrough=function(){this.setState(function(e){return!1===e.stalled?null:{stalled:!1}})},n.handleMediaTimeupdate=function(){var e=this.media,t=e.currentTime,n=e.played;this.state.trackLoading?this.media.currentTime=this.state.currentTime:this.setState({currentTime:t,playedRanges:H(n)})},n.handleMediaLoadedmetadata=function(){this.media.currentTime!==this.state.currentTime&&(this.media.currentTime=this.state.currentTime),this.setState(function(e){return!1===e.trackLoading?null:{trackLoading:!1}})},n.handleMediaVolumechange=function(){var e=this.media,t=e.volume,n=e.muted;this.setState({volume:t,muted:n})},n.handleMediaDurationchange=function(){var e=this.media.duration;this.setState({duration:e})},n.handleMediaProgress=function(){this.setState({bufferedRanges:H(this.media.buffered),seekableRanges:H(this.media.seekable)})},n.handleMediaLoopchange=function(){var e=this.media.loop;this.setState(function(t){return t.loop===e?null:{loop:e}})},n.handleMediaRatechange=function(){var e=this.media.playbackRate;this.setState(function(t){return t.playbackRate===e?null:{playbackRate:e}})},n.togglePause=function(e){if(clearTimeout(this.delayTimeout),"boolean"==typeof e?e:!this.state.paused)this.media.pause();else if(this.media.currentSrc)try{var t=this.media.play();t&&"function"==typeof t.catch&&t.catch(function(e){if("AbortError"!==e.name)return Promise.reject(e)}).catch(G)}catch(e){G(e)}},n.goToTrack=function(e,t){void 0===t&&(t=!0),clearTimeout(this.delayTimeout),this.setState(function(n){return Q(n,e,t)})},n.selectTrackIndex=function(e){var t=this.props.playlist;q(t)&&(e<0||e>t.length?Object(f.b)("Playlist index "+e+" is out of bounds!"):(this.state.shuffle&&this.shuffler.pickNextItem(e,this.state.activeTrackIndex),this.goToTrack(e)))},n.backSkip=function(){var e=this.props,t=e.playlist,n=e.stayOnBackSkipThreshold,r=this.media,i=this.state,a=i.cycle,s=i.activeTrackIndex,o=i.shuffle;if(!q(t)||r.currentTime>=n||!a&&s<1)r.currentTime=0;else{var l;if(o){var u=this.shuffler.findPreviousItem(s);if(void 0===u)return void(r.currentTime=0);l=j(t,u)}else(l=s-1)<0&&(l=t.length-1);this.goToTrack(l)}},n.forwardSkip=function(){var e,t=this.props.playlist,n=this.state,r=n.cycle,i=n.activeTrackIndex,a=n.shuffle;!q(t)||!r&&i+1>=t.length||(a?e=j(t,this.shuffler.findNextItem(i)):(e=i+1)>=t.length&&(e=0),this.goToTrack(e))},n.seekPreview=function(e){if(q(this.props.playlist)){var t={seekPreviewTime:e,seekInProgress:!0};switch(this.props.seekMode){case"paused":this.setState(function(e){var n=e.paused,r=e.awaitingResumeOnSeekComplete;return N({},t,{awaitingResumeOnSeekComplete:!n||r})}),this.media.currentTime=e,this.state.paused||this.togglePause(!0);break;case"immediate":this.setState(function(e){var n=e.paused,r=e.awaitingResumeOnSeekComplete;return N({},t,{awaitingResumeOnSeekComplete:!n||r})}),this.media.currentTime=e,this.state.awaitingResumeOnSeekComplete&&!this.media.ended&&this.togglePause(!1);break;case"onrelease":this.setState(t)}}},n.seekComplete=function(e){var t=this.state,n=t.seekPreviewTime,r=t.awaitingResumeOnSeekComplete,i={seekInProgress:!1,awaitingResumeOnSeekComplete:!1},a="number"==typeof e?e:n;isNaN(a)?this.setState(i):(this.setState(N({},i,{currentTime:a})),this.media.currentTime=a,r&&(this.media.ended?this.forwardSkip():this.togglePause(!1)))},n.setVolume=function(e,t){void 0===t&&(t=!0),t&&!this.state.setVolumeInProgress&&this.setState({setVolumeInProgress:!0});var n=D(e,0,1);this.media.muted=0===n,this.media.volume=n},n.setVolumeComplete=function(e){"number"==typeof e&&this.setVolume(e,!1),this.setState({setVolumeInProgress:!1}),this.media.muted||(this.lastStableVolume=this.media.volume)},n.toggleMuted=function(e){var t="boolean"==typeof e?e:!this.state.muted;this.media.muted=t,t||(this.media.volume=this.lastStableVolume)},n.toggleShuffle=function(e){var t="boolean"==typeof e?e:!this.state.shuffle;this.setState({shuffle:t})},n.setRepeatStrategy=function(e){if(-1!==h.indexOf(e))switch(e){case"track":this.media.loop=!0;break;case"playlist":this.setState({loop:!1,cycle:!0}),this.media.loop=!1;break;case"none":this.setState({loop:!1,cycle:!1}),this.media.loop=!1}else Object(f.b)('repeatStrategy "'+e+'" is not one of: '+h.split(", ")+".")},n.setPlaybackRate=function(e){this.media.playbackRate=e},n.getControlProps=function(){var e=this.props,t=this.state,n={playlist:e.playlist,activeTrackIndex:t.activeTrackIndex,trackLoading:t.trackLoading,paused:t.paused,currentTime:t.currentTime,seekPreviewTime:t.seekPreviewTime,seekInProgress:t.seekInProgress,awaitingResumeOnSeekComplete:t.awaitingResumeOnSeekComplete,duration:t.duration,bufferedRanges:t.bufferedRanges,playedRanges:t.playedRanges,seekableRanges:t.seekableRanges,volume:t.volume,muted:t.muted,shuffle:t.shuffle,stalled:t.stalled,playbackRate:t.playbackRate,setVolumeInProgress:t.setVolumeInProgress,repeatStrategy:A(t.loop,t.cycle),registerVideoHostElement:this.registerVideoHostElement,renderVideoIntoHostElement:this.renderVideoIntoHostElement,unregisterVideoHostElement:this.unregisterVideoHostElement,onTogglePause:this.togglePause,onSelectTrackIndex:this.selectTrackIndex,onBackSkip:this.backSkip,onForwardSkip:this.forwardSkip,onSeekPreview:this.seekPreview,onSeekComplete:this.seekComplete,onSetVolume:this.setVolume,onSetVolumeComplete:this.setVolumeComplete,onToggleMuted:this.toggleMuted,onToggleShuffle:this.toggleShuffle,onSetRepeatStrategy:this.setRepeatStrategy,onSetPlaybackRate:this.setPlaybackRate};if(this.playerContext)for(var r=Object.keys(this.playerContext),i=0;i<r.length;i++){var a=r[i];if(n[a]!==this.playerContext[a]){this.playerContext=n;break}}else this.playerContext=n;return this.playerContext},n.render=function(){var e=this,t=this.getControlProps();return a.a.createElement(i.Fragment,null,a.a.createElement("div",{ref:function(t){return e.mediaContainer=t},hidden:!0}),a.a.createElement(d.Provider,{value:t},"function"==typeof this.props.children?this.props.children(t):this.props.children))},t}(i.Component);Y.propTypes={playlist:o.a.arrayOf(w.isRequired).isRequired,autoplay:o.a.bool.isRequired,autoplayDelayInSeconds:o.a.number.isRequired,gapLengthInSeconds:o.a.number.isRequired,crossOrigin:y,defaultVolume:o.a.number.isRequired,defaultMuted:o.a.bool,defaultRepeatStrategy:b.isRequired,defaultShuffle:o.a.bool,defaultPlaybackRate:o.a.number.isRequired,startingTime:o.a.number.isRequired,startingTrackIndex:o.a.number.isRequired,loadFirstTrackOnPlaylistComplete:o.a.bool,seekMode:P.isRequired,maintainPlaybackRate:o.a.bool.isRequired,allowBackShuffle:o.a.bool,stayOnBackSkipThreshold:o.a.number.isRequired,supportedMediaSessionActions:o.a.arrayOf(S.isRequired).isRequired,mediaSessionSeekLengthInSeconds:o.a.number.isRequired,mediaElementRef:o.a.func,initialStateSnapshot:o.a.shape({__unstable__:o.a.object.isRequired}),onStateSnapshot:o.a.func,onActiveTrackUpdate:o.a.func,getPosterImageForTrack:o.a.func.isRequired,children:o.a.oneOfType([o.a.node,o.a.func]).isRequired},Y.defaultProps={autoplay:!1,autoplayDelayInSeconds:0,gapLengthInSeconds:0,defaultVolume:1,defaultMuted:!1,defaultRepeatStrategy:"playlist",defaultShuffle:!1,defaultPlaybackRate:1,startingTime:0,startingTrackIndex:0,loadFirstTrackOnPlaylistComplete:!0,seekMode:"immediate",maintainPlaybackRate:!1,allowBackShuffle:!1,stayOnBackSkipThreshold:5,supportedMediaSessionActions:["play","pause","previoustrack","nexttrack"],mediaSessionSeekLengthInSeconds:10,getPosterImageForTrack:function(e){return e&&e.artwork?e.artwork[0].src:""}};var Z=function(e){function t(){return e.apply(this,arguments)||this}z(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.groupContext.registerMediaElement(this.mediaElement)},n.componentWillUnmount=function(){this.props.groupContext.unregisterMediaElement(this.mediaElement)},n.render=function(){var e=this,t=this.props,n=t.groupContext,r=t.props,i=r.mediaElementRef,s=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(r,["mediaElementRef"]);return a.a.createElement(Y,B({},n.groupProps,s,{mediaElementRef:function(t){i&&i(t),e.mediaElement=t}}))},t}(i.Component);Z.propTypes={groupContext:o.a.shape({groupProps:o.a.object.isRequired,registerMediaElement:o.a.func.isRequired,unregisterMediaElement:o.a.func.isRequired}).isRequired};var $=function(e){return a.a.createElement(p.Consumer,null,function(t){return t?Object(i.createElement)(Z,{groupContext:t,props:e}):Object(i.createElement)(Y,e)})};function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){te(e,t,n[t])})}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var re=function(e){function t(t){var n;return(n=e.call(this,t)||this).registerMediaElement=n.registerMediaElement.bind(ne(n)),n.unregisterMediaElement=n.unregisterMediaElement.bind(ne(n)),n.enforceOneMediaSourceOnly=n.enforceOneMediaSourceOnly.bind(ne(n)),n.mediaElements=[],n}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e);var n=t.prototype;return n.registerMediaElement=function(e){this.mediaElements=this.mediaElements.concat(e),e.addEventListener("play",this.enforceOneMediaSourceOnly,!0),e.addEventListener("volumechange",this.enforceOneMediaSourceOnly,!0)},n.unregisterMediaElement=function(e){this.mediaElements=this.mediaElements.filter(function(t){return e!==t}),e.removeEventListener("play",this.enforceOneMediaSourceOnly,!0),e.removeEventListener("volumechange",this.enforceOneMediaSourceOnly,!0)},n.enforceOneMediaSourceOnly=function(e){var t=e.target,n=t.paused,r=t.muted;if(!n&&!r){var i=this.mediaElements,a=Array.isArray(i),s=0;for(i=a?i:i[Symbol.iterator]();;){var o;if(a){if(s>=i.length)break;o=i[s++]}else{if((s=i.next()).done)break;o=s.value}var l=o;l===t||l.muted||l.pause()}}},n.render=function(){var e=this;return a.a.createElement(p.Consumer,null,function(t){var n=t?ee({},t,{groupProps:ee({},t.groupProps,e.props)}):{groupProps:e.props,registerMediaElement:e.registerMediaElement,unregisterMediaElement:e.unregisterMediaElement};return a.a.createElement(p.Provider,{value:n},e.props.children)})},t}(i.Component);re.propTypes={children:o.a.node.isRequired};var ie=re,ae=Object(c.a)("FullscreenContext",{fullscreen:!1,requestFullscreen:function(){Object(f.b)("Fullscreen request ignored since there is no FullscreenContextProvider ancestor.")},requestExitFullscreen:function(){Object(f.b)("Exit fullscreen request ignored since there is no FullscreenContextProvider ancestor.")}});function se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var oe={width:"100%",height:"100%"},le=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={fullscreen:!1},n.requestFullscreen=n.requestFullscreen.bind(se(n)),n.requestExitFullscreen=n.requestExitFullscreen.bind(se(n)),n.handleFullscreenChange=n.handleFullscreenChange.bind(se(n)),n.fullscreenElement=null,n}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e);var n=t.prototype;return n.componentDidMount=function(){document.addEventListener("fullscreenchange",this.handleFullscreenChange),document.addEventListener("webkitfullscreenchange",this.handleFullscreenChange),document.addEventListener("mozfullscreenchange",this.handleFullscreenChange),document.addEventListener("msfullscreenchange",this.handleFullscreenChange)},n.componentWillUnmount=function(){document.removeEventListener("fullscreenchange",this.handleFullscreenChange),document.removeEventListener("webkitfullscreenchange",this.handleFullscreenChange),document.removeEventListener("mozfullscreenchange",this.handleFullscreenChange),document.removeEventListener("msfullscreenchange",this.handleFullscreenChange)},n.requestFullscreen=function(){this.props.fullscreenEnabled&&(this.fullscreenElement.requestFullscreen?this.fullscreenElement.requestFullscreen():this.fullscreenElement.webkitRequestFullscreen?this.fullscreenElement.webkitRequestFullscreen():this.fullscreenElement.mozRequestFullscreen?this.fullscreenElement.mozRequestFullScreen():this.fullscreenElement.msRequestFullscreen&&this.fullscreenElement.msRequestFullscreen())},n.requestExitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.mozExitFullscreen()},n.handleFullscreenChange=function(){var e=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;this.setState({fullscreen:e===this.fullscreenElement})},n.getFullscreenContext=function(){var e={fullscreen:this.state.fullscreen,requestFullscreen:this.requestFullscreen,requestExitFullscreen:this.requestExitFullscreen};return this.fullscreenContext&&e.fullscreen===this.fullscreenContext.fullscreen?this.fullscreenContext:this.fullscreenContext=e},n.render=function(){var e=this,t=this.getFullscreenContext();return a.a.createElement("div",{ref:function(t){return e.fullscreenElement=t},style:this.state.fullscreen?oe:void 0},a.a.createElement(ae.Provider,{value:t},"function"==typeof this.props.children?this.props.children(t):this.props.children))},t}(i.PureComponent);le.propTypes={fullscreenEnabled:o.a.bool.isRequired,children:o.a.oneOfType([o.a.node,o.a.func]).isRequired},le.defaultProps={fullscreenEnabled:!0};var ue=le;function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var de=function(e,t){var n={},r=e.displayName||e.name;function s(s){return a.a.createElement(ae.Consumer,null,function(o){return a.a.createElement(d.Consumer,null,function(a){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ce(e,t,n[t])})}return e}({},s),u=t,c=Array.isArray(u),d=0;for(u=c?u:u[Symbol.iterator]();;){var p;if(c){if(d>=u.length)break;p=u[d++]}else{if((d=u.next()).done)break;p=d.value}var h=p;a.hasOwnProperty(h)?l[h]=a[h]:o.hasOwnProperty(h)?l[h]=o[h]:n[h]||(Object(f.b)("Prop '"+h+"' for component "+r+" not found in playerContext or fullscreenContext."),n[h]=!0)}return Object(i.createElement)(e,l)})})}return r&&(s.displayName="PlayerContextFilter("+r+")"),s};n.d(t,"PlayerContextConsumer",function(){return pe}),n.d(t,"FullscreenContextConsumer",function(){return he}),n.d(t,"PlayerContextProvider",function(){return $}),n.d(t,"PlayerContextGroup",function(){return ie}),n.d(t,"FullscreenContextProvider",function(){return ue}),n.d(t,"playerContextFilter",function(){return de}),n.d(t,"PlayerPropTypes",function(){return r}),n.d(t,"logError",function(){return f.a}),n.d(t,"logWarning",function(){return f.b}),n.d(t,"convertToNumberWithinIntervalBounds",function(){return D}),n.d(t,"isPlaylistValid",function(){return q}),n.d(t,"repeatStrategyOptions",function(){return h});var pe=d.Consumer,he=ae.Consumer}])});
//# sourceMappingURL=cassette-core.min.js.map