!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("prop-types"),require("react"),require("@cassette/core"),require("resize-observer-polyfill")):"function"==typeof define&&define.amd?define(["prop-types","react","@cassette/core","resize-observer-polyfill"],t):"object"==typeof exports?exports.cassetteComponents=t(require("prop-types"),require("react"),require("@cassette/core"),require("resize-observer-polyfill")):e.cassetteComponents=t(e.PropTypes,e.React,e.cassetteCore,e.ResizeObserver)}(window,function(e,t,r,n){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist",r(r.s=4)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t,r){"use strict";r.r(t);var n=r(1),o=r.n(n),i=r(0),s=r.n(i),a=r(3),l=r.n(a);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var d="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return Date.now()};function h(e){return e+"px"}var m=function(e){function t(t){var r;return(r=e.call(this,t)||this).state={contentHeight:0},r.moveMarquee=r.moveMarquee.bind(p(r)),r.handleResize=r.handleResize.bind(p(r)),r}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e);var r=t.prototype;return r.componentDidMount=function(){this.animationFrameRequest=requestAnimationFrame(this.moveMarquee),this.marqueeContainerElementWidth=getComputedStyle(this.marqueeContainerElement).width;var e=getComputedStyle(this.movingContentContainerElement);this.movingContentContainerElementWidth=e.width,this.setState({contentHeight:e.height}),this.resizeObserver=new l.a(this.handleResize),this.resizeObserver.observe(this.marqueeContainerElement),this.resizeObserver.observe(this.movingContentContainerElement),this.lastMovementTime=d()},r.componentWillUnmount=function(){cancelAnimationFrame(this.animationFrameRequest),this.resizeObserver.disconnect()},r.moveMarquee=function(){var e=this.props,t=e.pixelsPerSecond,r=e.scrollDirection,n=d(),o=n-this.lastMovementTime;if(this.lastMovementTime=n,"left"===r?this.movingContentContainerElement.style.right=void 0:this.movingContentContainerElement.style.left=void 0,this.marqueeContainerElementWidth>=this.movingContentContainerElementWidth)this.movingContentContainerElement.style[r]=0;else{var i=t*o/1e3,s=function(e){return Number(e.slice(0,-2))}(this.movingContentContainerElement.style[r])-i;s>0-this.movingContentContainerElementWidth?this.movingContentContainerElement.style[r]=h(s):this.movingContentContainerElement.style[r]=h(this.marqueeContainerElementWidth)}this.animationFrameRequest=requestAnimationFrame(this.moveMarquee)},r.handleResize=function(e){var t=e,r=Array.isArray(t),n=0;for(t=r?t:t[Symbol.iterator]();;){var o;if(r){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}var i=o;i.target===this.marqueeContainerElement&&(this.marqueeContainerElementWidth=i.contentRect.width),i.target===this.movingContentContainerElement&&(this.movingContentContainerElementWidth=i.contentRect.width,this.setState({contentHeight:i.contentRect.height}))}},r.render=function(){var e=this,t=this.props,r=t.content,n=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,["content"]);return delete n.pixelsPerSecond,delete n.scrollDirection,o.a.createElement("div",c({},n,{ref:function(t){return e.marqueeContainerElement=t},style:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){u(e,t,r[t])})}return e}({position:"relative",overflow:"hidden",height:this.state.contentHeight},n.style||{})}),o.a.createElement("div",{ref:function(t){return e.movingContentContainerElement=t},style:{position:"absolute",whiteSpace:"nowrap"}},r))},t}(n.PureComponent);m.propTypes={content:s.a.node.isRequired,pixelsPerSecond:s.a.number.isRequired,scrollDirection:s.a.oneOf(["left","right"]).isRequired},m.defaultProps={pixelsPerSecond:30,scrollDirection:"left"};var f=m,g=r(2);var v=function(e,t){var r=100*(1-(e||0))+"%",n={position:"absolute",left:0,right:0,top:0,bottom:0};switch(t){case"left":n.left=r,n.willChange="left";break;case"right":n.right=r,n.willChange="right";break;case"up":n.top=r,n.willChange="top";break;case"down":n.bottom=r,n.willChange="bottom"}return n};var y=function(e,t){var r=100*(e||0)+"%",n={position:"absolute",transform:"translate(-50%, -50%)"};switch(t){case"left":n.top="50%",n.right=r,n.willChange="right",n.transform="translate(50%, -50%)";break;case"right":n.top="50%",n.left=r,n.willChange="left",n.transform="translate(-50%, -50%)";break;case"up":n.left="50%",n.bottom=r,n.willChange="bottom",n.transform="translate(-50%, 50%)";break;case"down":n.left="50%",n.top=r,n.willChange="top",n.transform="translate(-50%, -50%)"}return n};function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var C=Object(n.forwardRef)(function(e,t){var r=e.progressClassName,n=e.progressStyle,i=e.progress,s=e.progressDirection,a=e.handle,l=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,["progressClassName","progressStyle","progress","progressDirection","handle"]);return o.a.createElement("div",b({},l,{ref:t}),o.a.createElement("div",{style:{position:"relative",width:"100%",height:"100%",touchAction:"none"}},o.a.createElement("div",{className:r,style:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){O(e,t,r[t])})}return e}({},v(i,s),n||{})}),a&&o.a.createElement("div",{style:y(i,s)},a)))});C.propTypes={progressClassName:s.a.string,progressStyle:s.a.object,progress:s.a.number.isRequired,progressDirection:g.PlayerPropTypes.progressDirection.isRequired,handle:s.a.element};var P=C;function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var R=function(e){function t(t){var r;return(r=e.call(this,t)||this).progressContainer=null,r.setProgressContainerRef=r.setProgressContainerRef.bind(j(r)),r.handleAdjustProgress=r.handleAdjustProgress.bind(j(r)),r.handleAdjustComplete=r.handleAdjustComplete.bind(j(r)),r}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this;window.addEventListener("mousemove",this.handleAdjustProgress),document.addEventListener("touchmove",this.handleAdjustProgress),window.addEventListener("mouseup",this.handleAdjustComplete),document.addEventListener("touchend",this.handleAdjustComplete),setTimeout(function(){var t=document.createElement("style"),r="noselect_"+Math.random().toString(16).slice(2,7);t.innerText="."+r+"{\ncursor: default;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  -webkit-touch-callout: none;\n}",document.body.appendChild(t),e.noselectStyleElement=t,e.noselectClassName=r})},r.componentWillUnmount=function(){window.removeEventListener("mousemove",this.handleAdjustProgress),document.removeEventListener("touchmove",this.handleAdjustProgress),window.removeEventListener("mouseup",this.handleAdjustComplete),document.removeEventListener("touchend",this.handleAdjustComplete),this.toggleNoselect(!1),this.noselectStyleElement.parentNode.removeChild(this.noselectStyleElement)},r.setProgressContainerRef=function(e){this.progressContainer=e},r.toggleNoselect=function(e){document.body.classList[e?"add":"remove"](this.noselectClassName)},r.getProgressFromPageCoordinates=function(e,t){var r=this.progressContainer.getBoundingClientRect(),n=r.left,o=r.top,i=r.width,s=r.height,a=document.body,l=a.scrollLeft,c=a.scrollTop;switch(this.props.progressDirection){case"down":return(t-o-c)/s;case"left":return 1-(e-n-l)/i;case"up":return 1-(t-o-c)/s;case"right":default:return(e-n-l)/i}},r.handleAdjustProgress=function(e){var t=this.props,r=t.readonly,n=t.adjusting,o=t.onAdjustProgress;if(!r){if("mousedown"===e.type||"touchstart"===e.type)this.toggleNoselect(!0);else if(!n)return;e.preventDefault();var i="touch"===e.type.slice(0,5),s=i?e.targetTouches.item(0).pageX:e.pageX,a=i?e.targetTouches.item(0).pageY:e.pageY,l=this.getProgressFromPageCoordinates(s,a);o(Object(g.convertToNumberWithinIntervalBounds)(l,0,1))}},r.handleAdjustComplete=function(e){var t=this.props,r=t.adjusting,n=t.onAdjustComplete;this.toggleNoselect(!1),r&&(e.preventDefault(),"function"==typeof n&&n())},r.render=function(){var e=this.props,t=e.progressClassName,r=e.progressStyle,n=e.progress,i=e.progressDirection,s=e.handle,a=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,["progressClassName","progressStyle","progress","progressDirection","handle"]);return delete a.adjusting,delete a.readonly,delete a.onAdjustProgress,delete a.onAdjustComplete,o.a.createElement(P,w({},a,{ref:this.setProgressContainerRef,progressClassName:t,progressStyle:r,progress:n,progressDirection:i,handle:s,onMouseDown:this.handleAdjustProgress,onTouchStart:this.handleAdjustProgress}))},t}(n.PureComponent);R.propTypes={progressClassName:s.a.string,progressStyle:s.a.object,progress:s.a.number.isRequired,progressDirection:g.PlayerPropTypes.progressDirection.isRequired,handle:s.a.element,adjusting:s.a.bool.isRequired,readonly:s.a.bool.isRequired,onAdjustProgress:s.a.func.isRequired,onAdjustComplete:s.a.func.isRequired},R.defaultProps={readonly:!1};var S=R;function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var q=function(e){function t(t){var r;return(r=e.call(this,t)||this).state={realDisplayWidth:0,realDisplayHeight:0,containerWidth:0,containerHeight:0},r}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e);var r=t.prototype;return r.componentDidMount=function(){this.canvas.width=0,this.canvas.height=0,this.checkForBadStuff();var e=this.getDeviceDisplayDimensions(),t=e.imageResolutionX,r=e.imageResolutionY,n=this.props.pipeVideoStreamToCanvas(this.canvas,this.handleFrameUpdate.bind(this)),o=n.endStream,i=n.setCanvasSize,s=n.setPlaceholderImage;i(t,r),this.getPlaceholderImage(s),this.endStream=o,this.setCanvasSize=i,this.setPlaceholderImage=s,this.updateContainerDimensions(),this.containerResizeObserver=new l.a(this.updateContainerDimensions.bind(this)),this.containerResizeObserver.observe(this.containerElement)},r.componentDidUpdate=function(){this.checkForBadStuff();var e=this.getDeviceDisplayDimensions(),t=e.imageResolutionX,r=e.imageResolutionY;this.setCanvasSize(t,r),this.getPlaceholderImage(this.setPlaceholderImage)},r.componentWillUnmount=function(){this.endStream(),this.containerResizeObserver.disconnect()},r.checkForBadStuff=function(){this.warnedAboutBadStuff||!this.props.processFrame||this.props.imageResolutionX||this.props.imageResolutionY||(Object(g.logWarning)("VideoDisplay: Supplying a processFrame function without also giving a imageResolutionX or imageResolutionY means the video will be processed at the full resolution. This may lead to a poor framerate."),this.warnedAboutBadStuff=!0)},r.updateContainerDimensions=function(){var e=this.containerElement,t=e.offsetWidth,r=e.offsetHeight;this.setState(function(e){return t===e.containerWidth&&r===e.containerHeight?null:{containerWidth:t,containerHeight:r}})},r.getDeviceDisplayDimensions=function(){var e=this.props,t=e.imageResolutionX,r=e.imageResolutionY,n=e.scaleForDevicePixelRatio&&window.devicePixelRatio||1;return{imageResolutionX:t&&n*t,imageResolutionY:r&&n*r}},r.getPlaceholderImage=function(e){var t=this.props,r=t.playlist,n=t.activeTrackIndex,o=(0,t.getPlaceholderImageForTrack)(r[n]||null);o?o.naturalWidth&&o.naturalHeight?e(o):(o.addEventListener("load",function(){return e(o)}),o.addEventListener("error",function(){return e()})):e()},r.handleFrameUpdate=function(e,t){var r=this.canvas,n=r.width,o=r.height;if(n&&o&&this.setState(function(e){return n===e.realDisplayWidth&&o===e.realDisplayHeight?null:{realDisplayWidth:n,realDisplayHeight:o}}),this.props.processFrame&&n&&o&&(t||this.props.shouldProcessPlaceholderImages)){var i=e.getImageData(0,0,n,o),s=this.props.processFrame(i);s instanceof ImageData?e.putImageData(s,0,0):this.warnedAboutNoImageData||(Object(g.logWarning)("The processFrame function should return an ImageData object. Normally you'll just mutate the provided ImageData and return it."),this.warnedAboutNoImageData=!0)}},r.render=function(){var e=this,t=this.props,r=t.aspectRatio,n=t.fullscreen,i=t.maintainAspectRatioInFullscreen,s=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,["aspectRatio","fullscreen","maintainAspectRatioInFullscreen"]);delete s.pipeVideoStreamToCanvas,delete s.processFrame,delete s.imageResolutionX,delete s.imageResolutionY,delete s.scaleForDevicePixelRatio,delete s.playlist,delete s.activeTrackIndex,delete s.getPlaceholderImageForTrack,delete s.shouldProcessPlaceholderImages;var a=this.state,l=a.realDisplayWidth,c=a.realDisplayHeight,u=a.containerWidth,p=a.containerHeight,d={};if(l&&c&&u&&p){var h=l/c,m=u/p;h===m?(d.width=u,d.height=p):h>m?(d.width=u,d.height=u/h):(d.height=p,d.width=p*h)}var f=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){E(e,t,r[t])})}return e}({display:"flex",justifyContent:"center",alignItems:"center",background:"#000"},s.style||{});return r&&u&&(!n||i)&&(f.height&&!this.warnedAboutStyleOverride&&(Object(g.logWarning)("VideoDisplay cannot style.height prop which is overridden by aspectRatio."),this.warnedAboutStyleOverride=!0),f.height=u/function(e){var t=e.split(":").map(Number);return t[0]/t[1]}(r)),o.a.createElement("div",D({},s,{style:f,ref:function(t){return e.containerElement=t}}),o.a.createElement("canvas",{style:d,ref:function(t){return e.canvas=t}}))},t}(n.PureComponent);q.propTypes={pipeVideoStreamToCanvas:s.a.func.isRequired,playlist:s.a.arrayOf(g.PlayerPropTypes.track.isRequired).isRequired,activeTrackIndex:s.a.number.isRequired,fullscreen:s.a.bool,processFrame:s.a.func,imageResolutionX:s.a.number,imageResolutionY:s.a.number,scaleForDevicePixelRatio:s.a.bool.isRequired,aspectRatio:g.PlayerPropTypes.aspectRatio,getPlaceholderImageForTrack:s.a.func.isRequired,shouldProcessPlaceholderImages:s.a.bool.isRequired,maintainAspectRatioInFullscreen:s.a.bool.isRequired},q.defaultProps={scaleForDevicePixelRatio:!0,aspectRatio:"16:9",getPlaceholderImageForTrack:function(e){if(e&&e.artwork){var t=new Image;return t.src=e.artwork[0].src,t}},shouldProcessPlaceholderImages:!1,maintainAspectRatioInFullscreen:!1};var x=Object(g.playerContextFilter)(q,["pipeVideoStreamToCanvas","playlist","activeTrackIndex","fullscreen"]);r.d(t,"MaybeMarquee",function(){return f}),r.d(t,"ProgressBar",function(){return S}),r.d(t,"ProgressBarDisplay",function(){return P}),r.d(t,"VideoDisplay",function(){return x})}])});
//# sourceMappingURL=cassette-components.min.js.map